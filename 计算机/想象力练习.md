### 1. 背包算法

- 物品可重复

  ```js
  let w = [2, 4, 3, 7]
  let v = [3, 5, 4, 8]
  const result = new Array(10).fill(0);
  function knap() {
      for (let i = 0; i < w.length; i++) {
          for (let j = w[i]; j < result.length; j++) {
              result[j]=Math.max(result[j],v[i]+result[j-w[i]])
          }
      }
  
  }
  knap()
  console.log(result)
  ```

  

- 物品不可重复

  ```js
  const w = [2, 4, 3, 7]
  const v = [3, 5, 4, 10]
  const result = new Array(10).fill(0)
  function knapsack() {
    for (let i = 0; i < w.length; i++) {
      const preResult = [...result]
      for (let j = w[i]; j < result.length; j++) {
        result[j] = Math.max(result[j], v[i] + preResult[j - w[i]])
      }
    }
  }
  knapsack()
  console.log(result)
  
  ```



### 2. 运动

- startMove速度版

  ```js
  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
  </head>
  <body>
      <div id="div1" style="position:absolute;left:0;top:0;width:100px;height:100px;background-color: red;"></div>
      <script>
          let div1=document.querySelector('#div1')
          startMove(div1,{left:100,top:100,opacity:30},()=>{console.log(222)})
          function startMove(ele,config,cb){
              ele.timer=setInterval(()=>{
                  let bStop=true
                  for(let attr in config){
                      let current=0
                      if(attr=='opacity'){
                           current=parseFloat(getComputedStyle(div1,false)[attr])*100
                      }else{
                           current=parseInt(getComputedStyle(div1,false)[attr])
                      }
                      let speed=Math.ceil((config[attr]-current)/5)
                      if(current!=config[attr]){
                          bStop=false
                          if(attr=='opacity'){
                              ele.style[attr]=(speed+current)/100
                          }else{
                              ele.style[attr]=speed+current+'px'
                          }
                      }
                  }
                  if(bStop){
                      clearInterval(ele.timer)
                      cb&&cb()
                  }
                  
              },30)
          }
      </script>
  </body>
  </html>
  ```

- startMove时间版

  ```js
  <!DOCTYPE html>
  <html lang="en">
  
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
  </head>
  
  <body>
      <div id="div1" style="position:absolute;left:0;top:0;width:100px;height:100px;background-color: red;;"></div>
      <script>
          let div1 = document.querySelector('#div1')
          startMove(div1, { left: 100, top: 100, opacity: 30 }, 3000, () => { console.log(222) })
          function startMove(ele, config, duration, cb) {
              let tween = {
                  linear: (p1, p2, t1, t2) => {
                      return p1 + (p2 - p1) * (t1 / t2)
                  }
              }
              let startTime = Date.now()
              let oldAttr = {}
              for (let attr in config) {
                  if (attr == 'opacity') {
                      oldAttr[attr] = parseFloat(getComputedStyle(div1, false)[attr]) * 100
                  } else {
                      oldAttr[attr] = parseInt(getComputedStyle(div1, false)[attr])
                  }
              }
              ele.timer = setInterval(() => {
                  let currentTime = Date.now()
                  let elapse = currentTime - startTime
                  let bStop = true
                  for (let attr in config) {
                      let current = 0
                      if (elapse >= duration) {
                          current = config[attr]
                      } else {
                          current = tween.linear(oldAttr[attr], config[attr], elapse, duration)
                      }
                      if (current != config[attr]) {
                          bStop = false
                      }
                      if (attr == 'opacity') {
                              ele.style[attr] = current / 100
                          } else {
                              ele.style[attr] = current + 'px'
                          }
                  }
                  if (bStop) {
                      clearInterval(ele.timer)
                      cb && cb()
                  }
  
              }, 30)
          }
      </script>
  </body>
  
  </html>
  ```

### 3. 计算π

- 概率算法

  ```js
  function computedPai(amount){
      let inPaiNum=0
      for(let i=0;i<amount;i++){
          let [x1,y1]= [Math.random(),Math.random()]
          let [x2,y2]=[0,0]
          let dis=Math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2))
          if(dis<=1){
              inPaiNum++
          }
      }
      console.log(inPaiNum/amount*4,inPaiNum)
  }
  computedPai(100000000)
  ```



### 4. Promise

- 自己实现

  ```js
  const PENDING = 'PENDING'
  const RESOLVED = 'RESOLVED'
  const REJECTED = 'REJECTED'
  
  class Promise2 {
      constructor(fn) {
          this.status = PENDING
          this.resolvedArr = []
          this.rejectedArr = []
          fn(this.resolve, this.reject)
      }
      resolve = (obj) => {
          if (obj instanceof Promise2) {
              return obj.then(this.resolve)
          }
          this.resolvedArr.forEach((fn) => {
              fn(obj)
          })
          this.status = RESOLVED
      }
  
      reject = () => {
          this.rejectedArr.forEach((fn) => {
              fn()
          })
          this.status = REJECTED
  
      }
  
      then = (successFn, failFn) => {
          let p2 = new Promise2((resolve,reject) => {
              if (this.status == PENDING) {
                  let fn=()=>{
                      let x=successFn()
                      this.resolvePromise(p2,x,resolve,reject)
                  }
                  this.resolvedArr.push(fn)
                  this.rejectedArr.push(failFn)
              }
              if (this.status == RESOLVED) {
                  setTimeout(()=>{
                      let x=successFn()
                      this.resolvePromise(p2,x,resolve,reject)
                  })
              }
              if (this.status == REJECTED) {
                  setTimeout(()=>{
                      let x=failFn()
                      this.resolvePromise(p2,x,resolve,reject)
                  })
              }
          })
          return p2
  
      }
      resolvePromise=(promise,x,resolve,reject)=>{
          if(x==promise) throw new Error('cycle reference error')
          if(x instanceof Promise2){
              x.then((value)=>{
                  resolve(value)
              },(value)=>{
                  reject(value)
              })
          }else{
              resolve(x)
          }
      }
  }
  
  let resolve2 = null
  let p2 = new Promise2((resolve, reject) => {
      console.log('000')
      resolve2 = resolve
  
  })
  p2.then(() => {
      console.log(333)
  })
  
  let p = new Promise2((resolve, reject) => {
      setTimeout(() => {
          console.log(111)
          resolve2()
          resolve(p2)
      }, 1000)
  })
  
  p.then((val) => {
      console.log(222, val)
      return new Promise2((resolve,reject)=>{reject()})
  }).then(()=>{
      console.log(444)
  },()=>{
      console.log('error,555')
  })
  ```



### 5.俄罗斯方块

- 旋转

  ```html
  <!DOCTYPE html>
  <html lang="en">
  
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <style>
          #div1 div {
              width: 100px;
              height: 100px;
              border: 1px solid #ccc;
              box-sizing: border-box;
          }
      </style>
  </head>
  
  <body>
      <div id="div1" style="margin:100px auto;display:flex;flex-wrap: wrap;"></div>
      <script>
          let parent = document.querySelector('#div1')
          let arr = [[0, 0, 0], [0, 1, 0], [1, 1, 1]]
          function generateBlocks(ele, data, unit = 100) {
              ele.style.width = data[0].length * unit + 'px'
              let arr = data.flat()
              ele.innerHTML=''
              arr.forEach(item => {
                  if (item == 1) {
                      ele.innerHTML += '<div style="background:red;"></div>'
  
                  } else
                      ele.innerHTML += '<div></div>'
  
              });
          }
          function createArray(i, j) {
              return Array.from({ length: i }, () => Array.from({ length: j }, () => 0));
          }
  
          function rotateBlocks() {
              let result =createArray(arr[0].length,arr.length)
              for (let i = 0; i < arr.length; i++) {
                  for (let j = 0; j < arr[i].length; j++) {
                      result[j][arr[i].length - i - 1] = arr[i][j]
                  }
              }
              arr=result
              generateBlocks(parent, arr, 100)
          }
          document.addEventListener('click', rotateBlocks)
          generateBlocks(parent, arr, 100)
      </script>
  </body>
  
  </html>
  ```

  

